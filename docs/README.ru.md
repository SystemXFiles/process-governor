![Logo Process Governor](images/github-banner-readme.png)

[English version](../README.md)

---

**Process Governor** - это утилита на Python, предназначенная для управления процессами и службами в Windows путем
настройки их приоритетов, приоритетов ввода/вывода и привязки к ядрам на основе пользовательских правил, заданных в
JSON-конфигурации.

## Возможности

- Настройка приоритетов процессов и служб для повышения производительности.
- Управление приоритетами ввода/вывода для оптимизации использования ресурсов.
- Определение привязки к ядрам для процессов.
- Тонкая настройка процессов и служб Windows на основе [пользовательских правил](#формат-конфигурации) в файле `config.json`.

## Начало работы

Для начала работы с **Process Governor** выполните следующие шаги:

1. Скачайте последнюю готовую сборку по ссылке: [Latest Release](https://github.com/SystemXFiles/process-governor/releases/latest).
2. [Настройте правила](#формат-конфигурации) в файле `config.json`. 
Вы можете создать файл `config.json`, запустив программу один раз.
3. Запустите исполняемый файл `Process Governor.exe` с **правами администратора**. 
Это важно, чтобы программа могла внести необходимые изменения в приоритеты процессов и служб, приоритеты ввода-вывода и соответствие ядер.

Программу можно закрыть, обратившись к значку в системном трее:

![Tray menu screenshot](images/tray_menu_screenshot.png)

## Советы и трюки

1. [Оптимизация звука на ПК](tips'n'tricks/audio.ru.md)
2. [Оптимизация Starfield: Уменьшение лагов](tips'n'tricks/starfield.ru.md)

---

## Запуск из исходников

Для запуска **Process Governor** из исходников выполните следующие шаги:

1. Склонируйте этот репозиторий.
2. Установите необходимые зависимости с помощью `pip`: `pip install -r requirements.txt`
3. [Настройте правила](#формат-конфигурации) в файле `config.json`. 
Вы можете создать файл `config.json`, запустив программу один раз.
4. Запустите скрипт `process-governor.py` с правами администратора: `python process-governor.py`

## Создание портабельной сборки

Вы можете создать портативную версию программы, используя **PyInstaller**. Чтобы создать портативную версию, выполните следующие шаги:

1. Установите PyInstaller с помощью `pip install pyinstaller`.
2. Запустите скрипт `python build_portable.py`.
3. После завершения скрипта, вы найдете портативную версию в папке `dist`.

Теперь у вас есть портабельная версия программы, которую можно использовать без установки.

---

## Формат Конфигурации

Файл конфигурации для Process Governor имеет формат JSON и название `config.json`. 
Если файла конфигурации отсутствует, то запустите программу один раз, чтобы файл создался автоматически.
Ниже описание структуры и доступных параметров файла конфигурации.

### Секция `rules`

Секция `rules` определяет, как Process Governor будет управлять процессами и службами. Каждое правило представлено как
JSON-объект в массиве.

- `processSelector` (строка, опционально): Указывает имя процесса или шаблон для сопоставления. Вы можете использовать
  подстановочные символы, включая `*` и `?`, чтобы сопоставить несколько процессов.
    - Пример: `"processSelector": "example.exe"`
    - Пример с подстановочными символами: `"processSelector": "logioptionsplus_*.exe"`

- `serviceSelector` (строка, опционально): Указывает имя службы или шаблон для сопоставления. Вы можете использовать
  подстановочные символы, включая `*` и `?`, чтобы сопоставить несколько служб. Правила для служб имеют более высокий
  приоритет и переопределяют правила для процессов, если найдено совпадение.
    - Пример: `"serviceSelector": "MyService"`
    - Пример с подстановочными символами: `"serviceSelector": "Audio*"`

- `priority` (строка, опционально): Устанавливает приоритет процесса или службы. Допустимые значения:
    - `"Idle"`
    - `"BelowNormal"`
    - `"Normal"`
    - `"AboveNormal"`
    - `"High"`
    - `"Realtime"`
    - Пример: `"priority": "High" `

- `ioPriority` (строка, опционально): Устанавливает приоритет ввода/вывода для процесса или службы. Допустимые значения:
    - `"VeryLow"`
    - `"Low"`
    - `"Normal"`
    - `"High"`: Установка приоритета ввода-вывода на "High" может вызвать ошибку AccessDenied в большинстве случаев.
    - Пример: `"ioPriority": "Normal"`

- `affinity` (строка, опционально): Определяет привязку процесса к ядру CPU. Вы можете указать привязку следующим
  образом:
    - Диапазон, включительно (например, "1-5").
    - Конкретные ядра (например, "1;2;3;4;5").
    - Комбинация обоих вариантов (например, "1-4;5").
    - Пример (диапазон): `"affinity": "1-4"`
    - Пример (конкретные ядра): `"affinity": "0;2;4"`
    - Пример (комбинация): `"affinity": "1;3-5"`

### Пример Конфигурации

Вот пример файла `config.json` с правилами:

```json
{
  "ruleApplyIntervalSeconds": 1,
  "logging": {
    "enable": true,
    "filename": "logging.txt",
    "level": "WARN",
    "maxBytes": 1048576,
    "backupCount": 2
  },
  "rules": [
    {
      "processSelector": "example.exe",
      "priority": "High",
      "ioPriority": "Normal",
      "affinity": "1;3-5"
    },
    {
      "serviceSelector": "Audio*",
      "priority": "Realtime",
      "ioPriority": "High",
      "affinity": "0;2;4"
    }
  ]
}
```

В этом примере определены два правила: одно для процесса и одно для службы.

---

### Лицензия

Этот проект лицензирован согласно GNU General Public License v3.0 - см. файл [LICENSE](LICENSE) для подробностей.